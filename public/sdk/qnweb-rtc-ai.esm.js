var QNRtcAiManager=function(){function e(){}return e.set=function(e,t){this.cache[e]=t},e.get=function(e){return this.cache[e]},e.init=function(e,t){this.set("token",e),this.set("signCallback",t)},e.cache={},e}(),extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function __extends(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function __rest(e,t){var r={};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}var QNAudioToTextStatus,version="4.1.0",BASE_URL="https://ap-open-z0.qiniuapi.com/dora-sdk/api",WS_URL="wss://ap-open-ws.service-z0.qiniuapp.com/v2/asr",QNAudioToTextAnalyzer=(!function(e){e.AVAILABLE="AVAILABLE",e.DESTROY="DESTROY",e.ERROR="ERROR",e.DETECTING="DETECTING"}(QNAudioToTextStatus=QNAudioToTextStatus||{}),function(){function e(){this.status=QNAudioToTextStatus.AVAILABLE,this.isRecording=!1,this.startTime=Date.now(),this.leftDataList=[],this.rightDataList=[]}return e.prototype.close=function(){var e=this;if(!this.ws)throw new Error("WebSocket is not initialized: ".concat(this.ws));this.status===QNAudioToTextStatus.DETECTING&&(this.status=QNAudioToTextStatus.DESTROY,this.ws.close(1e3,"eos"),setTimeout(function(){e.ws.close(),e.ws=null},500))},e.prototype.initWebSocket=function(e){var t=this,r=(console.log("AudioToTextAnalyzer initWebSocket"),e.params),o=e.callback,e=e.audioBuffer,n=__assign({aue:1,e:Math.floor(Date.now()/1e3),voice_sample:e.sampleRate||16e3},r),i="".concat(WS_URL,"?").concat(Object.keys(n).map(function(e){return"".concat(e,"=").concat(n[e])}).join("&"));Promise.resolve(QNRtcAiManager.get("signCallback")(i)).then(function(e){t.ws=new WebSocket("".concat(i,"&token=").concat(e||null)),t.ws.binaryType="arraybuffer",t.ws.addEventListener("open",function(e){console.log("AudioToTextAnalyzer open",e),t.isRecording=!0,t.status=QNAudioToTextStatus.DETECTING,null!=o&&o.onStatusChange&&o.onStatusChange(t.status,"正在实时转化")}),t.ws.addEventListener("message",function(e){e=new TextDecoder("utf-8").decode(e.data),e=JSON.parse(e);null!=o&&o.onAudioToText&&o.onAudioToText(e)}),t.ws.addEventListener("error",function(e){console.log("AudioToTextAnalyzer error",e),t.isRecording=!1,t.status=QNAudioToTextStatus.ERROR,null!=o&&o.onStatusChange&&o.onStatusChange(t.status,"连接异常断线")}),t.ws.addEventListener("close",function(e){console.log("AudioToTextAnalyzer close",e),t.isRecording=!1,t.status=QNAudioToTextStatus.DESTROY,null!=o&&o.onStatusChange&&o.onStatusChange(t.status,"已经销毁不可用")})})},e.prototype.sendMessageToWebSocket=function(e){this.leftDataList.push(e.getChannelData(0).slice(0)),200<=Date.now()-this.startTime&&(e=this.mergeArray(this.leftDataList),e=Int16Array.from(e.map(function(e){return 0<e?32767*e:32768*e})).buffer,this.ws.send(e),this.startTime=Date.now(),this.leftDataList=[],this.rightDataList=[])},e.prototype.mergeArray=function(e){for(var t=e.length*e[0].length,r=new Float32Array(t),o=0,n=0;n<e.length;n++)r.set(e[n],o),o+=e[n].length;return r},e.prototype.interleaveLeftAndRight=function(e,t){for(var r=e.length+t.length,o=new Float32Array(r),n=0;n<e.length;n++){var i=2*n;o[i]=e[n],o[1+i]=t[n]}return o},e.startAudioToText=function(e,t,r){function o(e){n.ws||n.initWebSocket({params:t,callback:r,audioBuffer:e}),n.status===QNAudioToTextStatus.DETECTING&&n.sendMessageToWebSocket(e)}var n=new this;n.startTime=Date.now();return e.on("audioFrame",o),n.audioBufferHandler=o,n.audioTrack=e,n},e.prototype.getStatus=function(){return this.status},e.prototype.stopAudioToText=function(){if(this.audioTrack&&this.audioBufferHandler&&this.audioTrack.off("audioFrame",this.audioBufferHandler),!this.ws)throw new Error("ws is ".concat(this.ws));this.close()},e}()),commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},conversion={exports:{}},imageConversion=(!function(){function n(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}var r,o;conversion.exports=(r=[function(o,e,t){var h;function m(t){return["image/png","image/jpeg","image/gif"].some(e=>e===t)}t.r(e),t.d(e,"canvastoDataURL",function(){return p}),t.d(e,"canvastoFile",function(){return i}),t.d(e,"dataURLtoFile",function(){return g}),t.d(e,"dataURLtoImage",function(){return v}),t.d(e,"downloadFile",function(){return a}),t.d(e,"filetoDataURL",function(){return b}),t.d(e,"imagetoCanvas",function(){return w}),t.d(e,"urltoBlob",function(){return u}),t.d(e,"urltoImage",function(){return d}),t.d(e,"compress",function(){return l}),t.d(e,"compressAccurately",function(){return f}),t.d(e,"EImageType",function(){return h}),(t=h=h||{}).PNG="image/png",t.JPEG="image/jpeg",t.GIF="image/gif";var n=function(e,a,s,c){return new(s=s||Promise)(function(r,t){function o(e){try{i(c.next(e))}catch(e){t(e)}}function n(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((c=c.apply(e,a||[])).next())})};function p(e,t=.92,r=h.JPEG){return n(this,void 0,void 0,function*(){return m(r)||(r=h.JPEG),e.toDataURL(r,t)})}function i(e,r=.92,o=h.JPEG){return new Promise(t=>e.toBlob(e=>t(e),o,r))}var s=function(e,a,s,c){return new(s=s||Promise)(function(r,t){function o(e){try{i(c.next(e))}catch(e){t(e)}}function n(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((c=c.apply(e,a||[])).next())})};function g(i,a){return s(this,void 0,void 0,function*(){const e=i.split(",");let t=e[0].match(/:(.*?);/)[1];const r=atob(e[1]);let o=r.length;const n=new Uint8Array(o);for(;o--;)n[o]=r.charCodeAt(o);return m(a)&&(t=a),new Blob([n],{type:t})})}function v(o){return new Promise((e,t)=>{const r=new Image;r.onload=()=>e(r),r.onerror=()=>t(new Error("dataURLtoImage(): dataURL is illegal")),r.src=o})}function a(e,t){const r=document.createElement("a"),o=(r.href=window.URL.createObjectURL(e),r.download=t||Date.now().toString(36),document.body.appendChild(r),document.createEvent("MouseEvents"));o.initEvent("click",!1,!1),r.dispatchEvent(o),document.body.removeChild(r)}function b(r){return new Promise(t=>{const e=new FileReader;e.onloadend=e=>t(e.target.result),e.readAsDataURL(r)})}var c=function(e,a,s,c){return new(s=s||Promise)(function(r,t){function o(e){try{i(c.next(e))}catch(e){t(e)}}function n(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((c=c.apply(e,a||[])).next())})};function w(i,a={}){return c(this,void 0,void 0,function*(){const t=Object.assign({},a),e=document.createElement("canvas"),r=e.getContext("2d");let o,n;for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(t[i]=Number(t[i]));if(t.scale){const a=0<t.scale&&t.scale<10?t.scale:1;n=i.width*a,o=i.height*a}else n=t.width||t.height*i.width/i.height||i.width,o=t.height||t.width*i.height/i.width||i.height;switch([5,6,7,8].some(e=>e===t.orientation)?(e.height=n,e.width=o):(e.height=o,e.width=n),t.orientation){case 3:r.rotate(180*Math.PI/180),r.drawImage(i,-e.width,-e.height,e.width,e.height);break;case 6:r.rotate(90*Math.PI/180),r.drawImage(i,0,-e.width,e.height,e.width);break;case 8:r.rotate(270*Math.PI/180),r.drawImage(i,-e.height,0,e.height,e.width);break;case 2:r.translate(e.width,0),r.scale(-1,1),r.drawImage(i,0,0,e.width,e.height);break;case 4:r.translate(e.width,0),r.scale(-1,1),r.rotate(180*Math.PI/180),r.drawImage(i,-e.width,-e.height,e.width,e.height);break;case 5:r.translate(e.width,0),r.scale(-1,1),r.rotate(90*Math.PI/180),r.drawImage(i,0,-e.width,e.height,e.width);break;case 7:r.translate(e.width,0),r.scale(-1,1),r.rotate(270*Math.PI/180),r.drawImage(i,-e.height,0,e.height,e.width);break;default:r.drawImage(i,0,0,e.width,e.height)}return e})}function u(e){return fetch(e).then(e=>e.blob())}function d(o){return new Promise((e,t)=>{const r=new Image;r.onload=()=>e(r),r.onerror=()=>t(new Error("urltoImage(): Image failed to load, please check the image URL")),r.src=o})}var r=function(e,a,s,c){return new(s=s||Promise)(function(r,t){function o(e){try{i(c.next(e))}catch(e){t(e)}}function n(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((c=c.apply(e,a||[])).next())})};function l(n,i={}){return r(this,void 0,void 0,function*(){if(!(n instanceof Blob))throw new Error("compress(): First arg must be a Blob object or a File object.");if((i="object"!=typeof i?Object.assign({quality:i}):i).quality=Number(i.quality),Number.isNaN(i.quality))return n;const e=yield b(n);let t=e.split(",")[0].match(/:(.*?);/)[1],r=h.JPEG;m(i.type)&&(r=i.type,t=i.type);var o=yield g(yield p(yield w(yield v(e),Object.assign({},i)),i.quality,r),t);return o.size>n.size?n:o})}function f(l,f={}){return r(this,void 0,void 0,function*(){if(!(l instanceof Blob))throw new Error("compressAccurately(): First arg must be a Blob object or a File object.");if((f="object"!=typeof f?Object.assign({size:f}):f).size=Number(f.size),Number.isNaN(f.size))return l;if(1024*f.size>l.size)return l;f.accuracy=Number(f.accuracy),(!f.accuracy||f.accuracy<.8||.99<f.accuracy)&&(f.accuracy=.95);const t=f.size*(2-f.accuracy)*1024,r=1024*f.size,o=f.size*f.accuracy*1024,e=yield b(l);let n=e.split(",")[0].match(/:(.*?);/)[1],i=h.JPEG;m(f.type)&&(i=f.type,n=f.type);var d=yield w(yield v(e),Object.assign({},f));let a,s=.5;const c=[null,null];for(let e=1;e<=7;e++){const f=.75*(a=yield p(d,s,i)).length;if(7===e){(t<f||o>f)&&(a=[a,...c].filter(e=>e).sort((e,t)=>Math.abs(.75*e.length-r)-Math.abs(.75*t.length-r))[0]);break}if(t<f)c[1]=a,s-=Math.pow(.5,e+1);else{if(!(o>f))break;c[0]=a,s+=Math.pow(.5,e+1)}}var u=yield g(a,n);return u.size>l.size?l:u})}}],o={},n.m=r,n.c=o,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0))}(),conversion.exports);function dataURLToFile(e,t){for(var e=e.split(","),r=e[0].match(/:(.*?);/)[1],o=atob(e[1]),n=o.length,i=new Uint8Array(n);n--;)i[n]=o.charCodeAt(n);return new File([i],t,{type:r})}function blobToBase64(r){return new Promise(function(e){var t=new FileReader;t.readAsDataURL(r),t.onload=function(){e(t.result)}})}function blobToDataURI(o){return new Promise(function(t,e){var r=new FileReader;r.onload=function(e){t(e.target.result+"")},r.onerror=function(){e("Failed to read file!\n\n"+r.error)},r.readAsDataURL(o)})}function bind(e,t){return function(){return e.apply(t,arguments)}}!function(o){function e(e,t){var r=o.call(this,t)||this;return r.code=e,r.error=t,r}__extends(e,o)}(Error);const toString=Object.prototype["toString"],getPrototypeOf=Object["getPrototypeOf"],kindOf=(r=>e=>{const t=toString.call(e);return r[t]||(r[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=t=>(t=t.toLowerCase(),e=>kindOf(e)===t),typeOfTest=t=>e=>typeof e===t,isArray=Array["isArray"],isUndefined=typeOfTest("undefined");function isBuffer(e){return null!==e&&!isUndefined(e)&&null!==e.constructor&&!isUndefined(e.constructor)&&isFunction(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&isArrayBuffer(e.buffer)}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=e=>null!==e&&"object"==typeof e,isBoolean=e=>!0===e||!1===e,isPlainObject=e=>{if("object"!==kindOf(e))return!1;var t=getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=e=>isObject(e)&&isFunction(e.pipe),isFormData=e=>{var t="[object FormData]";return e&&("function"==typeof FormData&&e instanceof FormData||toString.call(e)===t||isFunction(e.toString)&&e.toString()===t)},isURLSearchParams=kindOfTest("URLSearchParams"),trim=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(t,r,{allOwnKeys:o=!1}={}){if(null!=t){let e;var n;if("object"!=typeof t&&(t=[t]),isArray(t))for(e=0,n=t.length;e<n;e++)r.call(null,t[e],e,t);else{var i,a=o?Object.getOwnPropertyNames(t):Object.keys(t),s=a.length;for(e=0;e<s;e++)i=a[e],r.call(null,t[i],i,t)}}}function merge(){const r={};var o=(e,t)=>{isPlainObject(r[t])&&isPlainObject(e)?r[t]=merge(r[t],e):isPlainObject(e)?r[t]=merge({},e):isArray(e)?r[t]=e.slice():r[t]=e};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&forEach(arguments[e],o);return r}const extend=(r,e,o,{allOwnKeys:t}={})=>(forEach(e,(e,t)=>{o&&isFunction(e)?r[t]=bind(e,o):r[t]=e},{allOwnKeys:t}),r),stripBOM=e=>e=65279===e.charCodeAt(0)?e.slice(1):e,inherits=(e,t,r,o)=>{e.prototype=Object.create(t.prototype,o),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject=(e,t,r,o)=>{var n,i;let a;const s={};if(t=t||{},null==e)return t;do{for(n=Object.getOwnPropertyNames(e),a=n.length;0<a--;)i=n[a],o&&!o(i,e,t)||s[i]||(t[i]=e[i],s[i]=!0)}while((e=!1!==r&&getPrototypeOf(e))&&(!r||r(e,t))&&e!==Object.prototype);return t},endsWith=(e,t,r)=>{e=String(e),(void 0===r||r>e.length)&&(r=e.length),r-=t.length;e=e.indexOf(t,r);return-1!==e&&e===r},toArray=e=>{if(!e)return null;if(isArray(e))return e;let t=e.length;if(!isNumber(t))return null;const r=new Array(t);for(;0<t--;)r[t]=e[t];return r},isTypedArray=(t=>e=>t&&e instanceof t)("undefined"!=typeof Uint8Array&&getPrototypeOf(Uint8Array)),forEachEntry=(e,t)=>{const r=e&&e[Symbol.iterator],o=r.call(e);for(;(n=o.next())&&!n.done;){var n=n.value;t.call(e,n[0],n[1])}},matchAll=(e,t)=>{var r;const o=[];for(;null!==(r=e.exec(t));)o.push(r);return o},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=e=>e.toLowerCase().replace(/[_-\s]([a-z\d])(\w*)/g,function(e,t,r){return t.toUpperCase()+r}),hasOwnProperty=(({hasOwnProperty:r})=>(e,t)=>r.call(e,t))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(r,o)=>{var e=Object.getOwnPropertyDescriptors(r);const n={};forEach(e,(e,t)=>{!1!==o(e,t,r)&&(n[t]=e)}),Object.defineProperties(r,n)},freezeMethods=o=>{reduceDescriptors(o,(e,t)=>{var r=o[t];isFunction(r)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not read-only method '"+t+"'")}))})},toObjectSet=(e,t)=>{const r={};var o=e=>{e.forEach(e=>{r[e]=!0})};return isArray(e)?o(e):o(String(e).split(t)),r},noop=()=>{},toFiniteNumber=(e,t)=>(e=+e,Number.isFinite(e)?e:t);var utils={isArray:isArray,isArrayBuffer:isArrayBuffer,isBuffer:isBuffer,isFormData:isFormData,isArrayBufferView:isArrayBufferView,isString:isString,isNumber:isNumber,isBoolean:isBoolean,isObject:isObject,isPlainObject:isPlainObject,isUndefined:isUndefined,isDate:isDate,isFile:isFile,isBlob:isBlob,isRegExp:isRegExp,isFunction:isFunction,isStream:isStream,isURLSearchParams:isURLSearchParams,isTypedArray:isTypedArray,isFileList:isFileList,forEach:forEach,merge:merge,extend:extend,trim:trim,stripBOM:stripBOM,inherits:inherits,toFlatObject:toFlatObject,kindOf:kindOf,kindOfTest:kindOfTest,endsWith:endsWith,toArray:toArray,forEachEntry:forEachEntry,matchAll:matchAll,isHTMLForm:isHTMLForm,hasOwnProperty:hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors:reduceDescriptors,freezeMethods:freezeMethods,toObjectSet:toObjectSet,toCamelCase:toCamelCase,noop:noop,toFiniteNumber:toFiniteNumber};function AxiosError(e,t,r,o,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),o&&(this.request=o),n&&(this.response=n)}utils.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{descriptors[e]={value:e}}),Object.defineProperties(AxiosError,descriptors),Object.defineProperty(prototype$1,"isAxiosError",{value:!0}),AxiosError.from=(e,t,r,o,n,i)=>{const a=Object.create(prototype$1);return utils.toFlatObject(e,a,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e),AxiosError.call(a,e.message,t,r,o,n),a.cause=e,a.name=e.name,i&&Object.assign(a,i),a};var browser=("object"==typeof self?self:window).FormData;function isVisitable(e){return utils.isPlainObject(e)||utils.isArray(e)}function removeBrackets(e){return utils.endsWith(e,"[]")?e.slice(0,-2):e}function renderKey(e,t,r){return e?e.concat(t).map(function(e,t){return e=removeBrackets(e),!r&&t?"["+e+"]":e}).join(r?".":""):t}function isFlatArray(e){return utils.isArray(e)&&!e.some(isVisitable)}const predicates=utils.toFlatObject(utils,{},null,function(e){return/^is[A-Z]/.test(e)});function isSpecCompliant(e){return e&&utils.isFunction(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator]}function toFormData(e,n,t){if(!utils.isObject(e))throw new TypeError("target must be an object");n=n||new(browser||FormData);const d=(t=utils.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!utils.isUndefined(t[e])})).metaTokens,i=t.visitor||o,a=t.dots,s=t.indexes;const r=(t.Blob||"undefined"!=typeof Blob&&Blob)&&isSpecCompliant(n);if(!utils.isFunction(i))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(utils.isDate(e))return e.toISOString();if(!r&&utils.isBlob(e))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils.isArrayBuffer(e)||utils.isTypedArray(e)?r&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function o(e,r,t){let o=e;if(e&&!t&&"object"==typeof e)if(utils.endsWith(r,"{}"))r=d?r:r.slice(0,-2),e=JSON.stringify(e);else if(utils.isArray(e)&&isFlatArray(e)||utils.isFileList(e)||utils.endsWith(r,"[]")&&(o=utils.toArray(e)))return r=removeBrackets(r),o.forEach(function(e,t){utils.isUndefined(e)||null===e||n.append(!0===s?renderKey([r],t,a):null===s?r:r+"[]",c(e))}),!1;return!!isVisitable(e)||(n.append(renderKey(t,r,a),c(e)),!1)}const u=[],l=Object.assign(predicates,{defaultVisitor:o,convertValue:c,isVisitable:isVisitable});if(!utils.isObject(e))throw new TypeError("data must be an object");return function r(e,o){if(!utils.isUndefined(e)){if(-1!==u.indexOf(e))throw Error("Circular reference detected in "+o.join("."));u.push(e),utils.forEach(e,function(e,t){!0===(!(utils.isUndefined(e)||null===e)&&i.call(n,e,utils.isString(t)?t.trim():t,o,l))&&r(e,o?o.concat(t):[t])}),u.pop()}}(e),n}function encode$1(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function AxiosURLSearchParams(e,t){this._pairs=[],e&&toFormData(e,this,t)}const prototype=AxiosURLSearchParams.prototype;function encode(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(e,t,r){if(!t)return e;var o=r&&r.encode||encode;const n=r&&r.serialize;let i;return(i=n?n(t,r):utils.isURLSearchParams(t)?t.toString():new AxiosURLSearchParams(t,r).toString(o))&&(-1!==(t=e.indexOf("#"))&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+i),e}prototype.append=function(e,t){this._pairs.push([e,t])},prototype.toString=function(t){const r=t?function(e){return t.call(this,e,encode$1)}:encode$1;return this._pairs.map(function(e){return r(e[0])+"="+r(e[1])},"").join("&")};class InterceptorManager{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){utils.forEach(this.handlers,function(e){null!==e&&t(e)})}}var transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1="undefined"!=typeof URLSearchParams?URLSearchParams:AxiosURLSearchParams,FormData$1=FormData;const isStandardBrowserEnv=(()=>{var e;return("undefined"==typeof navigator||"ReactNative"!==(e=navigator.product)&&"NativeScript"!==e&&"NS"!==e)&&("undefined"!=typeof window&&"undefined"!=typeof document)})();var platform={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob},isStandardBrowserEnv:isStandardBrowserEnv,protocols:["http","https","file","blob","url","data"]};function toURLEncodedForm(e,t){return toFormData(e,new platform.classes.URLSearchParams,Object.assign({visitor:function(e,t,r,o){return o.defaultVisitor.apply(this,arguments)}},t))}function parsePropPath(e){return utils.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}function arrayToObject(e){const t={};var r=Object.keys(e);let o;var n,i=r.length;for(o=0;o<i;o++)n=r[o],t[n]=e[n];return t}function formDataToJSON(e){if(utils.isFormData(e)&&utils.isFunction(e.entries)){const r={};return utils.forEachEntry(e,(e,t)=>{!function e(t,r,o,n){let i=t[n++];var a=Number.isFinite(+i),s=n>=t.length;return i=!i&&utils.isArray(o)?o.length:i,s?utils.hasOwnProp(o,i)?o[i]=[o[i],r]:o[i]=r:(o[i]&&utils.isObject(o[i])||(o[i]=[]),e(t,r,o[i],n)&&utils.isArray(o[i])&&(o[i]=arrayToObject(o[i]))),!a}(parsePropPath(e),t,r,0)}),r}return null}function settle(e,t,r){const o=r.config.validateStatus;r.status&&o&&!o(r.status)?t(new AxiosError("Request failed with status code "+r.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):e(r)}var cookies=platform.isStandardBrowserEnv?{write:function(e,t,r,o,n,i){const a=[];a.push(e+"="+encodeURIComponent(t)),utils.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),utils.isString(o)&&a.push("path="+o),utils.isString(n)&&a.push("domain="+n),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){e=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function isAbsoluteURL(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function combineURLs(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}function buildFullPath(e,t){return e&&!isAbsoluteURL(t)?combineURLs(e,t):t}var isURLSameOrigin=platform.isStandardBrowserEnv?function(){const r=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");let t;function n(e){let t=e;return r&&(o.setAttribute("href",t),t=o.href),o.setAttribute("href",t),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}return t=n(window.location.href),function(e){e=utils.isString(e)?n(e):e;return e.protocol===t.protocol&&e.host===t.host}}():function(){return!0};function CanceledError(e,t,r){AxiosError.call(this,null==e?"canceled":e,AxiosError.ERR_CANCELED,t,r),this.name="CanceledError"}function parseProtocol(e){e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return e&&e[1]||""}utils.inherits(CanceledError,AxiosError,{__CANCEL__:!0});const ignoreDuplicateOf=utils.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);var parseHeaders=e=>{const t={};let r,o,n;return e&&e.split("\n").forEach(function(e){n=e.indexOf(":"),r=e.substring(0,n).trim().toLowerCase(),o=e.substring(n+1).trim(),!r||t[r]&&ignoreDuplicateOf[r]||("set-cookie"===r?t[r]?t[r].push(o):t[r]=[o]:t[r]=t[r]?t[r]+", "+o:o)}),t};const $internals=Symbol("internals"),$defaults=Symbol("defaults");function normalizeHeader(e){return e&&String(e).trim().toLowerCase()}function normalizeValue(e){return!1===e||null==e?e:utils.isArray(e)?e.map(normalizeValue):String(e)}function parseTokens(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;for(var o;o=r.exec(e);)t[o[1]]=o[2];return t}function matchHeaderValue(e,t,r,o){return utils.isFunction(o)?o.call(this,t,r):utils.isString(t)?utils.isString(o)?-1!==t.indexOf(o):utils.isRegExp(o)?o.test(t):void 0:void 0}function formatHeader(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function buildAccessors(e,n){const t=utils.toCamelCase(" "+n);["get","set","has"].forEach(o=>{Object.defineProperty(e,o+t,{value:function(e,t,r){return this[o].call(this,n,e,t,r)},configurable:!0})})}function findKey(e,t){t=t.toLowerCase();var r=Object.keys(e);let o=r.length,n;for(;0<o--;)if(t===(n=r[o]).toLowerCase())return n;return null}function AxiosHeaders(e,t){e&&this.set(e),this[$defaults]=t||null}function speedometer(i,a){i=i||10;const s=new Array(i),c=new Array(i);let u=0,d=0,l;return a=void 0!==a?a:1e3,function(e){var t=Date.now(),r=c[d];l=l||t,s[u]=e,c[u]=t;let o=d,n=0;for(;o!==u;)n+=s[o++],o%=i;if((u=(u+1)%i)===d&&(d=(d+1)%i),!(t-l<a))return e=r&&t-r,e?Math.round(1e3*n/e):void 0}}function progressEventReducer(a,s){let c=0;const u=speedometer(50,250);return e=>{var t=e.loaded,e=e.lengthComputable?e.total:void 0,r=t-c,o=u(r),n=t<=e;const i={loaded:c=t,total:e,progress:e?t/e:void 0,bytes:r,rate:o||void 0,estimated:o&&e&&n?(e-t)/o:void 0};i[s?"download":"upload"]=!0,a(i)}}function xhrAdapter(l){return new Promise(function(d,r){var e=l.data;const t=AxiosHeaders.from(l.headers).normalize(),o=l.responseType;let n;function i(){l.cancelToken&&l.cancelToken.unsubscribe(n),l.signal&&l.signal.removeEventListener("abort",n)}utils.isFormData(e)&&platform.isStandardBrowserEnv&&t.setContentType(!1);let a=new XMLHttpRequest;l.auth&&(s=l.auth.username||"",u=l.auth.password?unescape(encodeURIComponent(l.auth.password)):"",t.set("Authorization","Basic "+btoa(s+":"+u)));var s=buildFullPath(l.baseURL,l.url);function c(){var e;a&&(e=AxiosHeaders.from("getAllResponseHeaders"in a&&a.getAllResponseHeaders()),settle(function(e){d(e),i()},function(e){r(e),i()},{data:o&&"text"!==o&&"json"!==o?a.response:a.responseText,status:a.status,statusText:a.statusText,headers:e,config:l,request:a}),a=null)}a.open(l.method.toUpperCase(),buildURL(s,l.params,l.paramsSerializer),!0),a.timeout=l.timeout,"onloadend"in a?a.onloadend=c:a.onreadystatechange=function(){a&&4===a.readyState&&(0!==a.status||a.responseURL&&0===a.responseURL.indexOf("file:"))&&setTimeout(c)},a.onabort=function(){a&&(r(new AxiosError("Request aborted",AxiosError.ECONNABORTED,l,a)),a=null)},a.onerror=function(){r(new AxiosError("Network Error",AxiosError.ERR_NETWORK,l,a)),a=null},a.ontimeout=function(){let e=l.timeout?"timeout of "+l.timeout+"ms exceeded":"timeout exceeded";var t=l.transitional||transitionalDefaults;l.timeoutErrorMessage&&(e=l.timeoutErrorMessage),r(new AxiosError(e,t.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,l,a)),a=null},!platform.isStandardBrowserEnv||(u=(l.withCredentials||isURLSameOrigin(s))&&l.xsrfCookieName&&cookies.read(l.xsrfCookieName))&&t.set(l.xsrfHeaderName,u),void 0===e&&t.setContentType(null),"setRequestHeader"in a&&utils.forEach(t.toJSON(),function(e,t){a.setRequestHeader(t,e)}),utils.isUndefined(l.withCredentials)||(a.withCredentials=!!l.withCredentials),o&&"json"!==o&&(a.responseType=l.responseType),"function"==typeof l.onDownloadProgress&&a.addEventListener("progress",progressEventReducer(l.onDownloadProgress,!0)),"function"==typeof l.onUploadProgress&&a.upload&&a.upload.addEventListener("progress",progressEventReducer(l.onUploadProgress)),(l.cancelToken||l.signal)&&(n=e=>{a&&(r(!e||e.type?new CanceledError(null,l,a):e),a.abort(),a=null)},l.cancelToken&&l.cancelToken.subscribe(n),l.signal&&(l.signal.aborted?n():l.signal.addEventListener("abort",n)));var u=parseProtocol(s);u&&-1===platform.protocols.indexOf(u)?r(new AxiosError("Unsupported protocol "+u+":",AxiosError.ERR_BAD_REQUEST,l)):a.send(e||null)})}Object.assign(AxiosHeaders.prototype,{set:function(e,r,t){const n=this;function o(e,t,r){var o=normalizeHeader(t);if(!o)throw new Error("header name must be a non-empty string");o=findKey(n,o);o&&!0!==r&&(!1===n[o]||!1===r)||(n[o||t]=normalizeValue(e))}return utils.isPlainObject(e)?utils.forEach(e,(e,t)=>{o(e,t,r)}):o(r,e,t),this},get:function(e,t){if(e=normalizeHeader(e)){e=findKey(this,e);if(e){var r=this[e];if(!t)return r;if(!0===t)return parseTokens(r);if(utils.isFunction(t))return t.call(this,r,e);if(utils.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}},has:function(e,t){return!!(e=normalizeHeader(e))&&!(!(e=findKey(this,e))||t&&!matchHeaderValue(this,this[e],e,t))},delete:function(e,t){const r=this;let o=!1;function n(e){(e=normalizeHeader(e))&&(!(e=findKey(r,e))||t&&!matchHeaderValue(r,r[e],e,t)||(delete r[e],o=!0))}return utils.isArray(e)?e.forEach(n):n(e),o},clear:function(){return Object.keys(this).forEach(this.delete.bind(this))},normalize:function(o){const n=this,i={};return utils.forEach(this,(e,t)=>{var r=findKey(i,t);if(r)return n[r]=normalizeValue(e),void delete n[t];r=o?formatHeader(t):String(t).trim();r!==t&&delete n[t],n[r]=normalizeValue(e),i[r]=!0}),this},toJSON:function(r){const o=Object.create(null);return utils.forEach(Object.assign({},this[$defaults]||null,this),(e,t)=>{null!=e&&!1!==e&&(o[t]=r&&utils.isArray(e)?e.join(", "):e)}),o}}),Object.assign(AxiosHeaders,{from:function(e){return utils.isString(e)?new this(parseHeaders(e)):e instanceof this?e:new this(e)},accessor:function(e){const r=(this[$internals]=this[$internals]={accessors:{}}).accessors,o=this.prototype;function t(e){var t=normalizeHeader(e);r[t]||(buildAccessors(o,e),r[t]=!0)}return utils.isArray(e)?e.forEach(t):t(e),this}}),AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent"]),utils.freezeMethods(AxiosHeaders.prototype),utils.freezeMethods(AxiosHeaders);const adapters={http:xhrAdapter,xhr:xhrAdapter};var adapters$1={getAdapter:e=>{if(utils.isString(e)){var t=adapters[e];if(!e)throw Error(utils.hasOwnProp(e)?`Adapter '${e}' is not available in the build`:`Can not resolve adapter '${e}'`);return t}if(!utils.isFunction(e))throw new TypeError("adapter is not a function");return e},adapters:adapters};const DEFAULT_CONTENT_TYPE={"Content-Type":"application/x-www-form-urlencoded"};function getDefaultAdapter(){let e;return"undefined"!=typeof XMLHttpRequest?e=adapters$1.getAdapter("xhr"):"undefined"!=typeof process&&"process"===utils.kindOf(process)&&(e=adapters$1.getAdapter("http")),e}function stringifySafely(e,t,r){if(utils.isString(e))try{return(t||JSON.parse)(e),utils.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(r||JSON.stringify)(e)}const defaults={transitional:transitionalDefaults,adapter:getDefaultAdapter(),transformRequest:[function(e,t){const r=t.getContentType()||"";var o=-1<r.indexOf("application/json"),n=utils.isObject(e),i=(n&&utils.isHTMLForm(e)&&(e=new FormData(e)),utils.isFormData(e));if(i)return o?JSON.stringify(formDataToJSON(e)):e;if(utils.isArrayBuffer(e)||utils.isBuffer(e)||utils.isStream(e)||utils.isFile(e)||utils.isBlob(e))return e;if(utils.isArrayBufferView(e))return e.buffer;if(utils.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();if(n){if(-1<r.indexOf("application/x-www-form-urlencoded"))return toURLEncodedForm(e,this.formSerializer).toString();if((i=utils.isFileList(e))||-1<r.indexOf("multipart/form-data")){const a=this.env&&this.env.FormData;return toFormData(i?{"files[]":e}:e,a&&new a,this.formSerializer)}}return n||o?(t.setContentType("application/json",!1),stringifySafely(e)):e}],transformResponse:[function(e){var t=this.transitional||defaults.transitional,r=t&&t.forcedJSONParsing,o="json"===this.responseType;if(e&&utils.isString(e)&&(r&&!this.responseType||o)){r=!(t&&t.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(e){if(r){if("SyntaxError"===e.name)throw AxiosError.from(e,AxiosError.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(e){return 200<=e&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};function transformData(e,t){const r=this||defaults;var o=t||r;const n=AxiosHeaders.from(o.headers);let i=o.data;return utils.forEach(e,function(e){i=e.call(r,i,n.normalize(),t?t.status:void 0)}),n.normalize(),i}function isCancel(e){return!(!e||!e.__CANCEL__)}function throwIfCancellationRequested(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new CanceledError}function dispatchRequest(t){throwIfCancellationRequested(t),t.headers=AxiosHeaders.from(t.headers),t.data=transformData.call(t,t.transformRequest);const e=t.adapter||defaults.adapter;return e(t).then(function(e){return throwIfCancellationRequested(t),e.data=transformData.call(t,t.transformResponse,e),e.headers=AxiosHeaders.from(e.headers),e},function(e){return isCancel(e)||(throwIfCancellationRequested(t),e&&e.response&&(e.response.data=transformData.call(t,t.transformResponse,e.response),e.response.headers=AxiosHeaders.from(e.response.headers))),Promise.reject(e)})}function mergeConfig(t,r){r=r||{};const o={};function n(e,t){return utils.isPlainObject(e)&&utils.isPlainObject(t)?utils.merge(e,t):utils.isPlainObject(t)?utils.merge({},t):utils.isArray(t)?t.slice():t}function i(e){return utils.isUndefined(r[e])?utils.isUndefined(t[e])?void 0:n(void 0,t[e]):n(t[e],r[e])}function e(e){if(!utils.isUndefined(r[e]))return n(void 0,r[e])}function a(e){return utils.isUndefined(r[e])?utils.isUndefined(t[e])?void 0:n(void 0,t[e]):n(void 0,r[e])}function s(e){return e in r?n(t[e],r[e]):e in t?n(void 0,t[e]):void 0}const c={url:e,method:e,data:e,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s};return utils.forEach(Object.keys(t).concat(Object.keys(r)),function(e){const t=c[e]||i;var r=t(e);utils.isUndefined(r)&&t!==s||(o[e]=r)}),o}utils.forEach(["delete","get","head"],function(e){defaults.headers[e]={}}),utils.forEach(["post","put","patch"],function(e){defaults.headers[e]=utils.merge(DEFAULT_CONTENT_TYPE)});const VERSION="1.1.3",validators$1={},deprecatedWarnings=(["object","boolean","number","function","string","symbol"].forEach((t,r)=>{validators$1[t]=function(e){return typeof e===t||"a"+(r<1?"n ":" ")+t}}),{});function assertOptions(e,t,r){if("object"!=typeof e)throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);var o=Object.keys(e);let n=o.length;for(;0<n--;){var i=o[n];const s=t[i];if(s){var a=e[i],a=void 0===a||s(a,i,e);if(!0!==a)throw new AxiosError("option "+i+" must be "+a,AxiosError.ERR_BAD_OPTION_VALUE)}else if(!0!==r)throw new AxiosError("Unknown option "+i,AxiosError.ERR_BAD_OPTION)}}validators$1.transitional=function(o,n,r){function i(e,t){return"[Axios v"+VERSION+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return(e,t,r)=>{if(!1===o)throw new AxiosError(i(t," has been removed"+(n?" in "+n:"")),AxiosError.ERR_DEPRECATED);return n&&!deprecatedWarnings[t]&&(deprecatedWarnings[t]=!0,console.warn(i(t," has been deprecated since v"+n+" and will be removed in the near future"))),!o||o(e,t,r)}};var validator={assertOptions:assertOptions,validators:validators$1};const validators=validator.validators;class Axios{constructor(e){this.defaults=e,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{};var{transitional:e,paramsSerializer:d}=t=mergeConfig(this.defaults,t),e=(void 0!==e&&validator.assertOptions(e,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),void 0!==d&&validator.assertOptions(d,{encode:validators.function,serialize:validators.function},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase(),t.headers&&utils.merge(t.headers.common,t.headers[t.method]));e&&utils.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),t.headers=new AxiosHeaders(t.headers,e);const r=[];let o=!0;this.interceptors.request.forEach(function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,r.unshift(e.fulfilled,e.rejected))});const n=[];this.interceptors.response.forEach(function(e){n.push(e.fulfilled,e.rejected)});let i,a=0,s;if(!o){const u=[dispatchRequest.bind(this),void 0];for(u.unshift.apply(u,r),u.push.apply(u,n),s=u.length,i=Promise.resolve(t);a<s;)i=i.then(u[a++],u[a++]);return i}s=r.length;let c=t;for(a=0;a<s;){const l=r[a++],f=r[a++];try{c=l(c)}catch(e){f.call(this,e);break}}try{i=dispatchRequest.call(this,c)}catch(e){return Promise.reject(e)}for(a=0,s=n.length;a<s;)i=i.then(n[a++],n[a++]);return i}getUri(e){return buildURL(buildFullPath((e=mergeConfig(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}utils.forEach(["delete","get","head","options"],function(r){Axios.prototype[r]=function(e,t){return this.request(mergeConfig(t||{},{method:r,url:e,data:(t||{}).data}))}}),utils.forEach(["post","put","patch"],function(n){function e(o){return function(e,t,r){return this.request(mergeConfig(r||{},{method:n,headers:o?{"Content-Type":"multipart/form-data"}:{},url:e,data:t}))}}Axios.prototype[n]=e(),Axios.prototype[n+"Form"]=e(!0)});class CancelToken{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(e){o=e});const n=this;this.promise.then(t=>{if(n._listeners){let e=n._listeners.length;for(;0<e--;)n._listeners[e](t);n._listeners=null}}),this.promise.then=e=>{let t;const r=new Promise(e=>{n.subscribe(e),t=e}).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e(function(e,t,r){n.reason||(n.reason=new CanceledError(e,t,r),o(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){!this._listeners||-1!==(e=this._listeners.indexOf(e))&&this._listeners.splice(e,1)}static source(){let t;return{token:new CancelToken(function(e){t=e}),cancel:t}}}function spread(t){return function(e){return t.apply(null,e)}}function isAxiosError(e){return utils.isObject(e)&&!0===e.isAxiosError}function createInstance(t){var e=new Axios(t);const r=bind(Axios.prototype.request,e);return utils.extend(r,Axios.prototype,e,{allOwnKeys:!0}),utils.extend(r,e,null,{allOwnKeys:!0}),r.create=function(e){return createInstance(mergeConfig(t,e))},r}const axios=createInstance(defaults);axios.Axios=Axios,axios.CanceledError=CanceledError,axios.CancelToken=CancelToken,axios.isCancel=isCancel,axios.VERSION=VERSION,axios.toFormData=toFormData,axios.AxiosError=AxiosError,axios.Cancel=axios.CanceledError,axios.all=function(e){return Promise.all(e)},axios.spread=spread,axios.isAxiosError=isAxiosError,axios.formToJSON=e=>formDataToJSON(utils.isHTMLForm(e)?new FormData(e):e);var request=axios.create({baseURL:BASE_URL}),QNAuthoritativeFaceComparer=(request.interceptors.request.use(function(e){var t=__assign(__assign({},e),{headers:__assign(__assign({},e.headers),{Authorization:QNRtcAiManager.get("token"),"Content-Type":"application/json"})});return"post"===e.method.toLowerCase()?__assign(__assign({},t),{data:{request:e.data}}):t},function(e){return Promise.reject(e)}),request.interceptors.response.use(function(e){return e.data},function(e){return Promise.reject(e)}),function(){function e(){}return e.run=function(e,t){e=dataURLToFile(e.getCurrentFrameData(),"photo");return imageConversion.compressAccurately(e,24).then(function(e){return blobToBase64(e)}).then(function(e){return request.post("/face-hdphotoauth",__assign({photo_b64:e.split(",")[1]},t))})},e}()),RecordRTC$1={exports:{}},RecordRTC=(!function(t){function A(r,n){if(!r)throw"First parameter is required.";n=new b(r,n=n||{type:"video"});var i=this;function l(e){e&&(n.initCallback=function(){e(),e=n.initCallback=null});var t=new w(r,n);(c=new t(r,n)).record(),s("recording"),n.disableLogs||console.log("Initialized recorderType:",c.constructor.name,"for output-type:",n.type)}function t(o){if(o=o||function(){},c){if("paused"===i.state)return i.resumeRecording(),void setTimeout(function(){t(o)},1);"recording"===i.state||n.disableLogs||console.warn('Recording state should be: "recording", however current state is: ',i.state),n.disableLogs||console.log("Stopped recording "+n.type+" stream."),"gif"!==n.type?c.stop(e):(c.stop(),e()),s("stopped")}else u();function e(e){if(c){Object.keys(c).forEach(function(e){"function"!=typeof c[e]&&(i[e]=c[e])});var t,r=c.blob;if(!r){if(!e)throw"Recording failed.";c.blob=r=e}if(r&&!n.disableLogs&&console.log(r.type,"->",y(r.size)),o){try{t=T.createObjectURL(r)}catch(e){}"function"==typeof o.call?o.call(i,t):o(t)}n.autoWriteToDisk&&a(function(e){var t={};t[n.type+"Blob"]=e,v.Store(t)})}else"function"==typeof o.call?o.call(i,""):o("")}}function f(e){postMessage((new FileReaderSync).readAsDataURL(e))}function a(t,e){if(!t)throw"Pass a callback function over getDataURL.";var r,o=(e||c||{}).blob;if(!o)return n.disableLogs||console.warn("Blob encoder did not finish its job yet."),void setTimeout(function(){a(t,e)},1e3);"undefined"==typeof Worker||navigator.mozGetUserMedia?((r=new FileReader).readAsDataURL(o),r.onload=function(e){t(e.target.result)}):((r=function(e){try{var t=T.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),r=new Worker(t);return T.revokeObjectURL(t),r}catch(e){}}(f)).onmessage=function(e){t(e.data)},r.postMessage(o))}function o(e){e=e||0,"paused"!==i.state?"stopped"!==i.state&&(e>=i.recordingDuration?t(i.onRecordingStopped):(e+=1e3,setTimeout(function(){o(e)},1e3))):setTimeout(function(){o(e)},1e3)}function s(e){i&&(i.state=e,"function"==typeof i.onStateChanged.call?i.onStateChanged.call(i,e):i.onStateChanged(e))}var c,e='It seems that recorder is destroyed or "startRecording" is not invoked for '+n.type+" recorder.";function u(){!0!==n.disableLogs&&console.warn(e)}var h,d={startRecording:function(e){return n.disableLogs||console.log("RecordRTC version: ",i.version),(n=e?new b(r,e):n).disableLogs||console.log("started recording "+n.type+" stream."),c?(c.clearRecordedData(),c.record(),s("recording"),i.recordingDuration&&o()):l(function(){i.recordingDuration&&o()}),i},stopRecording:t,pauseRecording:function(){c?"recording"===i.state?(s("paused"),c.pause(),n.disableLogs||console.log("Paused recording.")):n.disableLogs||console.warn("Unable to pause the recording. Recording state: ",i.state):u()},resumeRecording:function(){c?"paused"===i.state?(s("recording"),c.resume(),n.disableLogs||console.log("Resumed recording.")):n.disableLogs||console.warn("Unable to resume the recording. Recording state: ",i.state):u()},initRecorder:l,setRecordingDuration:function(e,t){if(void 0===e)throw"recordingDuration is required.";if("number"!=typeof e)throw"recordingDuration must be a number.";return i.recordingDuration=e,i.onRecordingStopped=t||function(){},{onRecordingStopped:function(e){i.onRecordingStopped=e}}},clearRecordedData:function(){c?(c.clearRecordedData(),n.disableLogs||console.log("Cleared old recorded data.")):u()},getBlob:function(){if(c)return c.blob;u()},getDataURL:a,toURL:function(){if(c)return T.createObjectURL(c.blob);u()},getInternalRecorder:function(){return c},save:function(e){c?R(c.blob,e):u()},getFromDisk:function(e){c?A.getFromDisk(n.type,e):u()},setAdvertisementArray:function(e){n.advertisement=[];for(var t=e.length,r=0;r<t;r++)n.advertisement.push({duration:r,image:e[r]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){"recording"!==i.state||n.disableLogs||console.warn("Stop an active recorder."),c&&"function"==typeof c.clearRecordedData&&c.clearRecordedData(),c=null,s("inactive"),i.blob=null},onStateChanged:function(e){n.disableLogs||console.log("Recorder state changed:",e)},state:"inactive",getState:function(){return i.state},destroy:function(){var e=n.disableLogs;n={disableLogs:!0},i.reset(),s("destroyed"),d=i=null,C.AudioContextConstructor&&(C.AudioContextConstructor.close(),C.AudioContextConstructor=null),n.disableLogs=e,n.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return i=d;for(h in d)this[h]=d[h];return i=this,d}function b(e,t){return t.recorderType||t.type||(t.audio&&t.video?t.type="video":t.audio&&!t.video&&(t.type="audio")),t.recorderType&&!t.type&&(t.recorderType===x||t.recorderType===f||void 0!==B&&t.recorderType===B?t.type="video":t.recorderType===D?t.type="gif":t.recorderType===u?t.type="audio":t.recorderType===g&&(E(e,"audio").length&&E(e,"video").length||!E(e,"audio").length&&E(e,"video").length?t.type="video":E(e,"audio").length&&!E(e,"video").length&&(t.type="audio"))),void 0!==g&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(t.mimeType||(t.mimeType="video/webm"),t.type||(t.type=t.mimeType.split("/")[0]),t.bitsPerSecond),t.type||(t.mimeType&&(t.type=t.mimeType.split("/")[0]),t.type||(t.type="audio")),t}function w(e,t){var r;return(d||n||a)&&(r=u),"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&!d&&(r=g),"video"===t.type&&(d||a)&&(r=x,void 0!==B&&"undefined"!=typeof ReadableStream&&(r=B)),"gif"===t.type&&(r=D),"canvas"===t.type&&(r=f),l()&&r!==f&&r!==D&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(E(e,"video").length||E(e,"audio").length)&&("audio"===t.type?"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("audio/webm")&&(r=g):"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("video/webm")&&(r=g)),e instanceof Array&&e.length&&(r=F),t.recorderType&&(r=t.recorderType),!t.disableLogs&&r&&r.name&&console.log("Using recorderType:",r.name||r.constructor.name),r=!r&&c?g:r}function r(a){this.addStream=function(e){e&&(a=e)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var e,t,r,o,n=this.mediaType,i=this.mimeType||{audio:null,video:null,gif:null};if("function"!=typeof n.audio&&l()&&!E(a,"audio").length&&(n.audio=!1),"function"!=typeof n.video&&l()&&!E(a,"video").length&&(n.video=!1),"function"!=typeof n.gif&&l()&&!E(a,"video").length&&(n.gif=!1),!n.audio&&!n.video&&!n.gif)throw"MediaStream must have either audio or video tracks.";n.audio&&(e=null,"function"==typeof n.audio&&(e=n.audio),this.audioRecorder=new A(a,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:e,mimeType:i.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),n.video||this.audioRecorder.startRecording()),n.video&&(e=null,"function"==typeof n.video&&(e=n.video),t=a,l()&&n.audio&&"function"==typeof n.audio&&(o=E(a,"video")[0],s?((t=new p).addTrack(o),e&&e===x&&(e=g)):(t=new p).addTrack(o)),this.videoRecorder=new A(t,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:e,mimeType:i.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),n.audio||this.videoRecorder.startRecording()),n.audio&&n.video&&(r=this,o=!0===l(),!0===(o=n.audio instanceof u&&n.video||!0!==n.audio&&!0!==n.video&&n.audio!==n.video?!1:o)?(r.audioRecorder=null,r.videoRecorder.startRecording()):r.videoRecorder.initRecorder(function(){r.audioRecorder.initRecorder(function(){r.videoRecorder.startRecording(),r.audioRecorder.startRecording()})})),n.gif&&(e=null,"function"==typeof n.gif&&(e=n.gif),this.gifRecorder=new A(a,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:e,mimeType:i.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(t){t=t||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(e){t(e,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(e){t(e,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(e){t(e,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var t={};return this.audioRecorder&&(t.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(t.video=this.videoRecorder.getBlob()),this.gifRecorder&&(t.gif=this.gifRecorder.getBlob()),e&&e(t),t},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(r){function o(e,t){var r;"undefined"!=typeof Worker?((r=function(e){var t,e=T.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),r=new Worker(e);if(void 0!==T)t=T;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";t=webkitURL}return t.revokeObjectURL(e),r}(function(e){postMessage((new FileReaderSync).readAsDataURL(e))})).onmessage=function(e){t(e.data)},r.postMessage(e)):((r=new FileReader).readAsDataURL(e),r.onload=function(e){t(e.target.result)})}this.getBlob(function(e){e.audio&&e.video?o(e.audio,function(t){o(e.video,function(e){r({audio:t,video:e})})}):e.audio?o(e.audio,function(e){r({audio:e})}):e.video&&o(e.video,function(e){r({video:e})})})},this.writeToDisk=function(){A.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){(e=e||{audio:!0,video:!0,gif:!0}).audio&&this.audioRecorder&&this.audioRecorder.save("string"==typeof e.audio?e.audio:""),e.video&&this.videoRecorder&&this.videoRecorder.save("string"==typeof e.video?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save("string"==typeof e.gif?e.gif:"")}}A.version="5.6.2",(t.exports=A).getFromDisk=function(r,o){if(!o)throw"callback is mandatory.";console.log("Getting recorded "+("all"===r?"blobs":r+" blob ")+" from disk!"),v.Fetch(function(e,t){"all"!==r&&t===r+"Blob"&&o&&o(e),"all"===r&&o&&o(e,t.replace("Blob",""))})},A.writeToDisk=function(e){console.log("Writing recorded blob(s) to disk!"),(e=e||{}).audio&&e.video&&e.gif?e.audio.getDataURL(function(r){e.video.getDataURL(function(t){e.gif.getDataURL(function(e){v.Store({audioBlob:r,videoBlob:t,gifBlob:e})})})}):e.audio&&e.video?e.audio.getDataURL(function(t){e.video.getDataURL(function(e){v.Store({audioBlob:t,videoBlob:e})})}):e.audio&&e.gif?e.audio.getDataURL(function(t){e.gif.getDataURL(function(e){v.Store({audioBlob:t,gifBlob:e})})}):e.video&&e.gif?e.video.getDataURL(function(t){e.gif.getDataURL(function(e){v.Store({videoBlob:t,gifBlob:e})})}):e.audio?e.audio.getDataURL(function(e){v.Store({audioBlob:e})}):e.video?e.video.getDataURL(function(e){v.Store({videoBlob:e})}):e.gif&&e.gif.getDataURL(function(e){v.Store({gifBlob:e})})},r.getFromDisk=A.getFromDisk,r.writeToDisk=A.writeToDisk,void 0!==A&&(A.MRecordRTC=r);(e=void 0!==commonjsGlobal?commonjsGlobal:null)&&"undefined"==typeof window&&void 0!==commonjsGlobal&&(commonjsGlobal.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function(){}},commonjsGlobal.console||(commonjsGlobal.console={}),void 0!==commonjsGlobal.console.log&&void 0!==commonjsGlobal.console.error||(commonjsGlobal.console.error=commonjsGlobal.console.log=commonjsGlobal.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(e.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},e.HTMLVideoElement=function(){}),"undefined"==typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(e.screen={width:0,height:0}),void 0===T&&(e.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),e.window=commonjsGlobal);var i,h=window.requestAnimationFrame,m=(void 0===h&&("undefined"!=typeof webkitRequestAnimationFrame?h=webkitRequestAnimationFrame:"undefined"!=typeof mozRequestAnimationFrame?h=mozRequestAnimationFrame:"undefined"!=typeof msRequestAnimationFrame?h=msRequestAnimationFrame:void 0===h&&(i=0,h=function(e,t){var r=(new Date).getTime(),o=Math.max(0,16-(r-i)),n=setTimeout(function(){e(r+o)},o);return i=r+o,n})),window.cancelAnimationFrame),e=(void 0===m&&("undefined"!=typeof webkitCancelAnimationFrame?m=webkitCancelAnimationFrame:"undefined"!=typeof mozCancelAnimationFrame?m=mozCancelAnimationFrame:"undefined"!=typeof msCancelAnimationFrame?m=msCancelAnimationFrame:void 0===m&&(m=function(e){clearTimeout(e)})),window.AudioContext),T=(void 0===e&&("undefined"!=typeof webkitAudioContext&&(e=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(e=mozAudioContext)),window.URL),n=(void 0===T&&"undefined"!=typeof webkitURL&&(T=webkitURL),"undefined"!=typeof navigator&&void 0===navigator.getUserMedia&&(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia)),!(-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveBlob&&!navigator.msSaveOrOpenBlob)),a=!!window.opera||-1!==navigator.userAgent.indexOf("OPR/"),s=-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&"netscape"in window&&/ rv:/.test(navigator.userAgent),d=!a&&!n&&!!navigator.webkitGetUserMedia||o()||-1!==navigator.userAgent.toLowerCase().indexOf("chrome/"),c=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),p=(c&&!d&&-1!==navigator.userAgent.indexOf("CriOS")&&(d=!(c=!1)),window.MediaStream);function y(e){if(0===e)return"0 Bytes";var t=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return(e/Math.pow(1e3,t)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][t]}function R(e,t){if(!e)throw"Blob object is required.";if(!e.type)try{e.type="video/webm"}catch(e){}var r=(e.type||"video/webm").split("/")[1],o=(-1!==r.indexOf(";")&&(r=r.split(";")[0]),t&&-1!==t.indexOf(".")&&(t=(o=t.split("."))[0],r=o[1]),(t||Math.round(9999999999*Math.random())+888888888)+"."+r);if(void 0!==navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,o);if(void 0!==navigator.msSaveBlob)return navigator.msSaveBlob(e,o);t=document.createElement("a");t.href=T.createObjectURL(e),t.download=o,t.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(t),"function"==typeof t.click?t.click():(t.target="_blank",t.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),T.revokeObjectURL(t.href)}function o(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||(!("undefined"==typeof process||"object"!=typeof process.versions||!process.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&0<=navigator.userAgent.indexOf("Electron"))}function E(e,t){return e&&e.getTracks?e.getTracks().filter(function(e){return e.kind===(t||"audio")}):[]}function S(e,t){!("srcObject"in t)&&"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}void 0!==(p=void 0===p&&"undefined"!=typeof webkitMediaStream?webkitMediaStream:p)&&void 0===p.prototype.stop&&(p.prototype.stop=function(){this.getTracks().forEach(function(e){e.stop()})}),void 0!==A&&(A.invokeSaveAsDialog=R,A.getTracks=E,A.getSeekableBlob=function(e,o){if("undefined"==typeof EBML)throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var n=new EBML.Reader,i=new EBML.Decoder,a=EBML.tools,t=new FileReader;t.onload=function(e){i.decode(this.result).forEach(function(e){n.read(e)}),n.stop();var t=a.makeMetadataSeekable(n.metadatas,n.duration,n.cues),r=this.result.slice(n.metadataSize),t=new Blob([t,r],{type:"video/webm"});o(t)},t.readAsArrayBuffer(e)},A.bytesToSize=y,A.isElectron=o);var C={};function l(){if(s||c||n)return!0;var e,t=navigator.userAgent,r=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10);return(d||a)&&(e=t.indexOf("Chrome"),r=t.substring(e+7)),-1!==(t=(r=-1!==(t=r.indexOf(";"))?r.substring(0,t):r).indexOf(" "))&&(r=r.substring(0,t)),o=parseInt(""+r,10),isNaN(o)&&(r=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10)),49<=o}function g(r,o){var e,n=this;if(void 0===r)throw'First argument "MediaStream" is required.';if("undefined"==typeof MediaRecorder)throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";"audio"===(o=o||{mimeType:"video/webm"}).type&&(E(r,"video").length&&E(r,"audio").length&&(navigator.mozGetUserMedia?(e=new p).addTrack(E(r,"audio")[0]):e=new p(E(r,"audio")),r=e),o.mimeType&&-1!==o.mimeType.toString().toLowerCase().indexOf("audio")||(o.mimeType=d?"audio/webm":"audio/ogg"),o.mimeType&&"audio/ogg"!==o.mimeType.toString().toLowerCase()&&navigator.mozGetUserMedia&&(o.mimeType="audio/ogg"));var i,a=[];function s(){n.timestamps.push((new Date).getTime()),"function"==typeof o.onTimeStamp&&o.onTimeStamp(n.timestamps[n.timestamps.length-1],n.timestamps)}function c(e){return i&&i.mimeType?i.mimeType:e.mimeType||"video/webm"}function t(){a=[],i=null,n.timestamps=[]}this.getArrayOfBlobs=function(){return a},this.record=function(){n.blob=null,n.clearRecordedData(),n.timestamps=[],u=[],a=[];var t=o;o.disableLogs||console.log("Passing following config over MediaRecorder API.",t),i=i&&null,d&&!l()&&(t="video/vp8"),"function"==typeof MediaRecorder.isTypeSupported&&t.mimeType&&(MediaRecorder.isTypeSupported(t.mimeType)||(o.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",t.mimeType),t.mimeType="audio"===o.type?"audio/webm":"video/webm"));try{i=new MediaRecorder(r,t),o.mimeType=t.mimeType}catch(e){i=new MediaRecorder(r)}t.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in i&&!1===i.canRecordMimeType(t.mimeType)&&(o.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",t.mimeType)),i.ondataavailable=function(e){e.data&&u.push("ondataavailable: "+y(e.data.size)),"number"!=typeof o.timeSlice?!e.data||!e.data.size||e.data.size<100||n.blob?n.recordingCallback&&(n.recordingCallback(new Blob([],{type:c(t)})),n.recordingCallback=null):(n.blob=o.getNativeBlob?e.data:new Blob([e.data],{type:c(t)}),n.recordingCallback&&(n.recordingCallback(n.blob),n.recordingCallback=null)):e.data&&e.data.size&&(a.push(e.data),s(),"function"==typeof o.ondataavailable&&(e=o.getNativeBlob?e.data:new Blob([e.data],{type:c(t)}),o.ondataavailable(e)))},i.onstart=function(){u.push("started")},i.onpause=function(){u.push("paused")},i.onresume=function(){u.push("resumed")},i.onstop=function(){u.push("stopped")},i.onerror=function(e){e&&(e.name||(e.name="UnknownError"),u.push("error: "+e),o.disableLogs||(-1!==e.name.toString().toLowerCase().indexOf("invalidstate")?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",e):-1!==e.name.toString().toLowerCase().indexOf("notsupported")?console.error("MIME type (",t.mimeType,") is not supported.",e):-1!==e.name.toString().toLowerCase().indexOf("security")?console.error("MediaRecorder security error",e):"OutOfMemory"===e.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"IllegalStreamModification"===e.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"OtherRecordingError"===e.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"GenericError"===e.name?console.error("The UA cannot provide the codec or recording option that has been requested.",e):console.error("MediaRecorder Error",e)),!n.manuallyStopped&&i&&"inactive"===i.state?(delete o.timeslice,i.start(6e5)):setTimeout(void 0,1e3),"inactive"!==i.state&&"stopped"!==i.state&&i.stop())},"number"==typeof o.timeSlice?(s(),i.start(o.timeSlice)):i.start(36e5),o.initCallback&&o.initCallback()},this.timestamps=[],this.stop=function(e){e=e||function(){},n.manuallyStopped=!0,i&&(this.recordingCallback=e,"recording"===i.state&&i.stop(),"number"==typeof o.timeSlice&&setTimeout(function(){n.blob=new Blob(a,{type:c(o)}),n.recordingCallback(n.blob)},100))},this.pause=function(){i&&"recording"===i.state&&i.pause()},this.resume=function(){i&&"paused"===i.state&&i.resume()},this.clearRecordedData=function(){i&&"recording"===i.state&&n.stop(t),t()},this.getInternalRecorder=function(){return i},this.blob=null,this.getState=function(){return i&&i.state||"inactive"};var u=[],n=(this.getAllStates=function(){return u},void 0===o.checkForInactiveTracks&&(o.checkForInactiveTracks=!1),this);!function e(){if(i&&!1!==o.checkForInactiveTracks)return!1===function(){if("active"in r){if(!r.active)return!1}else if("ended"in r&&r.ended)return!1;return!0}()?(o.disableLogs||console.log("MediaStream seems stopped."),void n.stop()):void setTimeout(e,1e3)}(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}function u(t,o){if(!E(t,"audio").length)throw"Your stream has no audio tracks.";var n,i=this,f=[],h=[],a=!1,s=0,c=2,m=(o=o||{}).desiredSampRate;function p(){if(!1===o.checkForInactiveTracks)return!0;if("active"in t){if(!t.active)return!1}else if("ended"in t&&t.ended)return!1;return!0}function g(e,t){function r(e,d){var t,r=e.numberOfAudioChannels,o=e.leftBuffers.slice(0),n=e.rightBuffers.slice(0),i=e.sampleRate,a=e.internalInterleavedLength,e=e.desiredSampRate;function s(e,t,r){var o=Math.round(e.length*(t/r)),n=[],d=Number((e.length-1)/(o-1));n[0]=e[0];for(var i,a=1;a<o-1;a++){var s=a*d,c=Number(Math.floor(s)).toFixed(),u=Number(Math.ceil(s)).toFixed();n[a]=(i=e[c],u=e[u],i+(u-i)*(s-c))}return n[o-1]=e[e.length-1],n}function l(e,t){for(var r=new Float64Array(t),o=0,n=e.length,i=0;i<n;i++){var a=e[i];r.set(a,o),o+=a.length}return r}function c(e,t,r){for(var o=r.length,n=0;n<o;n++)e.setUint8(t+n,r.charCodeAt(n))}2===r&&(o=l(o,a),n=l(n,a),e&&(o=s(o,e,i),n=s(n,e,i))),1===r&&(o=l(o,a),e&&(o=s(o,e,i))),e&&(i=e),2===r&&(t=function(e,t){for(var r=e.length+t.length,o=new Float64Array(r),n=0,i=0;i<r;)o[i++]=e[n],o[i++]=t[n],n++;return o}(o,n));for(var a=(t=1===r?o:t).length,e=new ArrayBuffer(44+2*a),u=new DataView(e),f=(c(u,0,"RIFF"),u.setUint32(4,36+2*a,!0),c(u,8,"WAVE"),c(u,12,"fmt "),u.setUint32(16,16,!0),u.setUint16(20,1,!0),u.setUint16(22,r,!0),u.setUint32(24,i,!0),u.setUint32(28,i*r*2,!0),u.setUint16(32,2*r,!0),u.setUint16(34,16,!0),c(u,36,"data"),u.setUint32(40,2*a,!0),a),h=44,m=0;m<f;m++)u.setInt16(h,32767*t[m],!0),h+=2;if(d)return d({buffer:e,view:u});postMessage({buffer:e,view:u})}var o,n,i;e.noWorker?r(e,function(e){t(e.buffer,e.view)}):(n=r,n=T.createObjectURL(new Blob([n.toString(),";this.onmessage =  function (eee) {"+n.name+"(eee.data);}"],{type:"application/javascript"})),(i=new Worker(n)).workerURL=n,(o=i).onmessage=function(e){t(e.data.buffer,e.data.view),T.revokeObjectURL(o.workerURL),o.terminate()},o.postMessage(e))}!0===o.leftChannel&&(c=1),(!(c=1===o.numberOfAudioChannels?1:c)||c<1)&&(c=2),o.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+c),void 0===o.checkForInactiveTracks&&(o.checkForInactiveTracks=!0),this.record=function(){if(!1===p())throw"Please make sure MediaStream is active.";w(),R=b=!1,a=!0,void 0!==o.timeSlice&&S()},this.stop=function(r){r=r||function(){},a=!1,g({desiredSampRate:m,sampleRate:v,numberOfAudioChannels:c,internalInterleavedLength:s,leftBuffers:f,rightBuffers:1===c?[]:h,noWorker:o.noWorker},function(e,t){i.blob=new Blob([t],{type:"audio/wav"}),i.buffer=new ArrayBuffer(t.buffer.byteLength),i.view=t,i.sampleRate=m||v,i.bufferSize=d,i.length=s,R=!1,r&&r(i.blob)})},(A.Storage=void 0===A.Storage?{AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}:A.Storage).AudioContextConstructor&&"closed"!==A.Storage.AudioContextConstructor.state||(A.Storage.AudioContextConstructor=new A.Storage.AudioContext);var e=A.Storage.AudioContextConstructor,u=e.createMediaStreamSource(t),r=[0,256,512,1024,2048,4096,8192,16384],d=void 0===o.bufferSize?4096:o.bufferSize;if(-1===r.indexOf(d)&&(o.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(r,null,"\t"))),e.createJavaScriptNode)n=e.createJavaScriptNode(d,c,c);else{if(!e.createScriptProcessor)throw"WebAudio API has no support on this browser.";n=e.createScriptProcessor(d,c,c)}u.connect(n),o.bufferSize||(d=n.bufferSize);var v=void 0!==o.sampleRate?o.sampleRate:e.sampleRate||44100,b=((v<22050||96e3<v)&&(o.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),o.disableLogs||o.desiredSampRate&&console.log("Desired sample-rate: "+o.desiredSampRate),!1);function w(){f=[],s=0,b=a=R=!(h=[]),e=null,i.leftchannel=f,i.rightchannel=h,i.numberOfAudioChannels=c,i.desiredSampRate=m,i.sampleRate=v,i.recordingLength=s,l={left:[],right:[],recordingLength:0}}function y(){n&&(n.onaudioprocess=null,n.disconnect(),n=null),u&&(u.disconnect(),u=null),w()}this.pause=function(){b=!0},this.resume=function(){if(!1===p())throw"Please make sure MediaStream is active.";if(!a)return o.disableLogs||console.log("Seems recording has been restarted."),void this.record();b=!1},this.clearRecordedData=function(){o.checkForInactiveTracks=!1,a&&this.stop(y),y()},this.name="StereoAudioRecorder";var R=!(this.toString=function(){return this.name});n.onaudioprocess=function(e){var t,r;b||(!1===p()&&(o.disableLogs||console.log("MediaStream seems stopped."),n.disconnect(),a=!1),a?(R||(R=!0,o.onAudioProcessStarted&&o.onAudioProcessStarted(),o.initCallback&&o.initCallback()),t=e.inputBuffer.getChannelData(0),t=new Float32Array(t),f.push(t),2===c&&(e=e.inputBuffer.getChannelData(1),r=new Float32Array(e),h.push(r)),s+=d,i.recordingLength=s,void 0!==o.timeSlice&&(l.recordingLength+=d,l.left.push(t),2===c&&l.right.push(r))):u&&(u.disconnect(),u=null))},e.createMediaStreamDestination?n.connect(e.createMediaStreamDestination()):n.connect(e.destination),this.leftchannel=f,this.rightchannel=h,this.numberOfAudioChannels=c,this.desiredSampRate=m,this.sampleRate=v,i.recordingLength=s;var l={left:[],right:[],recordingLength:0};function S(){a&&"function"==typeof o.ondataavailable&&void 0!==o.timeSlice&&(l.left.length?(g({desiredSampRate:m,sampleRate:v,numberOfAudioChannels:c,internalInterleavedLength:l.recordingLength,leftBuffers:l.left,rightBuffers:1===c?[]:l.right},function(e,t){t=new Blob([t],{type:"audio/wav"});o.ondataavailable(t),setTimeout(S,o.timeSlice)}),l={left:[],right:[],recordingLength:0}):setTimeout(S,o.timeSlice))}}function f(n,i){if("undefined"==typeof html2canvas)throw"Please link: https://www.webrtc-experiment.com/screenshot.js";(i=i||{}).frameInterval||(i.frameInterval=10);var r,o,a,s=!1,e=(["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){e in document.createElement("canvas")&&(s=!0)}),!(!window.webkitRTCPeerConnection&&!window.webkitGetUserMedia||!window.chrome)),t=50,f=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(e&&f&&f[2]&&(t=parseInt(f[2],10)),e&&t<52&&(s=!1),s=i.useWhammyRecorder?!1:s)if(i.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),n instanceof HTMLCanvasElement)r=n;else{if(!(n instanceof CanvasRenderingContext2D))throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";r=n.canvas}else navigator.mozGetUserMedia&&(i.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));this.record=function(){if(a=!0,s&&!i.useWhammyRecorder){var e;"captureStream"in r?e=r.captureStream(25):"mozCaptureStream"in r?e=r.mozCaptureStream(25):"webkitCaptureStream"in r&&(e=r.webkitCaptureStream(25));try{var t=new p;t.addTrack(E(e,"video")[0]),e=t}catch(e){}if(!e)throw"captureStream API are NOT available.";(o=new g(e,{mimeType:i.mimeType||"video/webm"})).record()}else l.frames=[],d=(new Date).getTime(),u();i.initCallback&&i.initCallback()},this.getWebPImages=function(e){var o;"canvas"===n.nodeName.toLowerCase()&&(o=l.frames.length,l.frames.forEach(function(e,t){var r=o-t,r=(i.disableLogs||console.log(r+"/"+o+" frames remaining"),i.onEncodingCallback&&i.onEncodingCallback(r,o),e.image.toDataURL("image/webp",1));l.frames[t].image=r}),i.disableLogs||console.log("Generating WebM")),e()};var c=!(this.stop=function(t){a=!1;var r=this;s&&o?o.stop(t):this.getWebPImages(function(){l.compile(function(e){i.disableLogs||console.log("Recording finished!"),r.blob=e,r.blob.forEach&&(r.blob=new Blob([],{type:"video/webm"})),t&&t(r.blob),l.frames=[]})})});function h(){l.frames=[],c=a=!1}function u(){return c?(d=(new Date).getTime(),setTimeout(u,500)):"canvas"===n.nodeName.toLowerCase()?(e=(new Date).getTime()-d,d=(new Date).getTime(),l.frames.push({image:(t=document.createElement("canvas"),r=t.getContext("2d"),t.width=n.width,t.height=n.height,r.drawImage(n,0,0),t),duration:e}),void(a&&setTimeout(u,i.frameInterval))):void html2canvas(n,{grabMouse:void 0===i.showMousePointer||i.showMousePointer,onrendered:function(e){var t=(new Date).getTime()-d;if(!t)return setTimeout(u,i.frameInterval);d=(new Date).getTime(),l.frames.push({image:e.toDataURL("image/webp",1),duration:t}),a&&setTimeout(u,i.frameInterval)}});var e,t,r}this.pause=function(){c=!0,o instanceof g&&o.pause()},this.resume=function(){c=!1,o instanceof g?o.resume():a||this.record()},this.clearRecordedData=function(){a&&this.stop(h),h()},this.name="CanvasRecorder",this.toString=function(){return this.name};var d=(new Date).getTime(),l=new O.Video(100)}function x(t,o){function r(e){e=void 0!==e?e:10;var t=(new Date).getTime()-s;return t?i?(s=(new Date).getTime(),setTimeout(r,100)):(s=(new Date).getTime(),a.paused&&a.play(),u.drawImage(a,0,0,y.width,y.height),c.frames.push({duration:t,image:y.toDataURL("image/webp")}),void(n||setTimeout(r,e,e))):setTimeout(r,e,e)}function d(r,e,t,o,c){var n,i,a,s=document.createElement("canvas"),f=(s.width=y.width,s.height=y.height,s.getContext("2d")),d=[],h=-1===e,u=e&&0<e&&e<=r.length?e:r.length,m=0,p=0,g=0,v=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),b=t&&0<=t&&t<=1?t:0,w=o&&0<=o&&o<=1?o:0,l=!1;i=-1,a=(n={length:u,functionToLoop:function(e,t){function i(){!l&&c-a<=c*w||(h&&(l=!0),d.push(r[t])),e()}var a,s,c,u;l?i():((u=new Image).onload=function(){f.drawImage(u,0,0,y.width,y.height);var e=f.getImageData(0,0,y.width,y.height);a=0,s=e.data.length,c=e.data.length/4;for(var t=0;t<s;t+=4){var r=e.data[t],o=e.data[t+1],n=e.data[t+2];Math.sqrt(Math.pow(r-m,2)+Math.pow(o-p,2)+Math.pow(n-g,2))<=v*b&&a++}i()},u.src=r[t].image)},callback:function(){(d=d.concat(r.slice(u))).length<=0&&d.push(r[r.length-1]),c(d)}}).length,function e(){++i!==a?setTimeout(function(){n.functionToLoop(e,i)},1):n.callback()}()}(o=o||{}).frameInterval||(o.frameInterval=10),o.disableLogs||console.log("Using frames-interval:",o.frameInterval);var n=!(this.record=function(){o.width||(o.width=320),o.height||(o.height=240),o.video||(o.video={width:o.width,height:o.height}),o.canvas||(o.canvas={width:o.width,height:o.height}),y.width=o.canvas.width||320,y.height=o.canvas.height||240,u=y.getContext("2d"),o.video&&o.video instanceof HTMLVideoElement?(a=o.video.cloneNode(),o.initCallback&&o.initCallback()):(a=document.createElement("video"),S(t,a),a.onloadedmetadata=function(){o.initCallback&&o.initCallback()},a.width=o.video.width,a.height=o.video.height),a.muted=!0,a.play(),s=(new Date).getTime(),c=new O.Video,o.disableLogs||(console.log("canvas resolutions",y.width,"*",y.height),console.log("video width/height",a.width||y.width,"*",a.height||y.height)),r(o.frameInterval)}),i=!(this.stop=function(t){t=t||function(){},n=!0;var r=this;setTimeout(function(){d(c.frames,-1,null,null,function(e){c.frames=e,o.advertisement&&o.advertisement.length&&(c.frames=o.advertisement.concat(c.frames)),c.compile(function(e){r.blob=e,r.blob.forEach&&(r.blob=new Blob([],{type:"video/webm"})),t&&t(r.blob)})})},10)});function e(){c.frames=[],i=!(n=!0)}this.pause=function(){i=!0},this.resume=function(){i=!1,n&&this.record()},this.clearRecordedData=function(){n||this.stop(e),e()},this.name="WhammyRecorder",this.toString=function(){return this.name};var a,s,c,y=document.createElement("canvas"),u=y.getContext("2d")}void 0!==e?C.AudioContext=e:"undefined"!=typeof webkitAudioContext&&(C.AudioContext=webkitAudioContext),void 0!==A&&(A.Storage=C),void 0!==A&&(A.MediaStreamRecorder=g),void 0!==A&&(A.StereoAudioRecorder=u),void 0!==A&&(A.CanvasRecorder=f),void 0!==A&&(A.WhammyRecorder=x);k.prototype.add=function(e,t){if("toDataURL"in(e="canvas"in e?e.canvas:e)&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},k.prototype.compile=function(t){r=L,r=T.createObjectURL(new Blob([r.toString(),"this.onmessage =  function (eee) {"+r.name+"(eee.data);}"],{type:"application/javascript"})),e=new Worker(r),T.revokeObjectURL(r);var e,r=e;r.onmessage=function(e){e.data.error?console.error(e.data.error):t(e.data)},r.postMessage(this.frames)};var O={Video:k};function k(e){this.frames=[],this.duration=e||1,this.quality=.8}function L(e){function u(e){for(var t=[];0<e;)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}function d(e){return new Uint8Array(e.split("").map(function(e){return e.charCodeAt(0)}))}function l(e){var t=[];e=(e.length%8?new Array(9-e.length%8).join("0"):"")+e;for(var r=0;r<e.length;r+=8)t.push(parseInt(e.substr(r,8),2));return new Uint8Array(t)}function a(e){for(var t=0,r={};t<e.length;){var o=e.substr(t,4),n=(n=t,parseInt(e.substr(n+4,4).split("").map(function(e){e=e.charCodeAt(0).toString(2);return new Array(8-e.length+1).join("0")+e}).join(""),2)),i=e.substr(t+4+4,n);t+=8+n,r[o]=r[o]||[],"RIFF"===o||"LIST"===o?r[o].push(a(i)):r[o].push(i)}return r}e=new function(e){var t=function(e){if(e[0]){for(var t=e[0].width,r=e[0].height,o=e[0].duration,n=1;n<e.length;n++)o+=e[n].duration;return{duration:o,width:t,height:r}}postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."})}(e);if(!t)return[];for(var r,o=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:(r=t.duration,[].slice.call(new Uint8Array(new Float64Array([r]).buffer),0).map(function(e){return String.fromCharCode(e)}).reverse().join("")),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:t.width,id:176},{data:t.height,id:186}]}]}]}]}],n=0,i=0;n<e.length;){for(var a=[],s=0;a.push(e[n]),s+=e[n].duration,++n<e.length&&s<3e4;);var c={id:524531317,data:function(e,r,t){return[{data:e,id:231}].concat(t.map(function(e){var t=function(e){var t=0;e.keyframe&&(t|=128);e.invisible&&(t|=8);e.lacing&&(t|=e.lacing<<1);e.discardable&&(t|=1);if(127<e.trackNum)throw"TrackNumber > 127 not supported";return[128|e.trackNum,e.timecode>>8,255&e.timecode,t].map(function(e){return String.fromCharCode(e)}).join("")+e.frame}({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(r)});return r+=e.duration,{data:t,id:163}}))}(i,0,a)};o[1].data.push(c),i+=s}return function e(t){var r=[];for(var o=0;o<t.length;o++){var n=t[o].data,i=(n="string"==typeof(n="number"==typeof(n="object"==typeof n?e(n):n)?l(n.toString(2)):n)?d(n):n).size||n.byteLength||n.length,a=Math.ceil(Math.ceil(Math.log(i)/Math.log(2))/8),i=i.toString(2),i=new Array(7*a+7+1-i.length).join("0")+i,a=new Array(a).join("0")+"1"+i;r.push(u(t[o].id)),r.push(l(a)),r.push(n)}return new Blob(r,{type:"video/webm"})}(o)}(e.map(function(e){var t=function(e){for(var t=e.RIFF[0].WEBP[0],r=t.indexOf("*"),o=0,n=[];o<4;o++)n[o]=t.charCodeAt(r+3+o);return{width:16383&(n[1]<<8|n[0]),height:16383&(n[3]<<8|n[2]),data:t,riff:e}}(a(atob(e.image.slice(23))));return t.duration=e.duration,t}));postMessage(e)}void 0!==A&&(A.Whammy=O);var v={init:function(){var e,r,t,o=this;function n(e){e.createObjectStore(o.dataStoreName)}function i(){var e=r.transaction([o.dataStoreName],"readwrite");function t(t){e.objectStore(o.dataStoreName).get(t).onsuccess=function(e){o.callback&&o.callback(e.target.result,t)}}o.videoBlob&&e.objectStore(o.dataStoreName).put(o.videoBlob,"videoBlob"),o.gifBlob&&e.objectStore(o.dataStoreName).put(o.gifBlob,"gifBlob"),o.audioBlob&&e.objectStore(o.dataStoreName).put(o.audioBlob,"audioBlob"),t("audioBlob"),t("videoBlob"),t("gifBlob")}"undefined"!=typeof indexedDB&&void 0!==indexedDB.open?(e=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),(t=indexedDB.open(e,1)).onerror=o.onError,t.onsuccess=function(){(r=t.result).onerror=o.onError,r.setVersion&&1!==r.version?r.setVersion(1).onsuccess=function(){n(r),i()}:i()},t.onupgradeneeded=function(e){n(e.target.result)}):console.error("IndexedDB API are not available in this browser.")},Fetch:function(e){return this.callback=e,this.init(),this},Store:function(e){return this.audioBlob=e.audioBlob,this.videoBlob=e.videoBlob,this.gifBlob=e.gifBlob,this.init(),this},onError:function(e){console.error(JSON.stringify(e,null,"\t"))},dataStoreName:"recordRTC",dbName:null};function D(e,r){"undefined"==typeof GIFEncoder&&((d=document.createElement("script")).src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(d)),r=r||{};var d,o=e instanceof CanvasRenderingContext2D||e instanceof HTMLCanvasElement,n=(this.record=function(){"undefined"!=typeof GIFEncoder&&t?(o||(r.width||(r.width=i.offsetWidth||320),r.height||(r.height=i.offsetHeight||240),r.video||(r.video={width:r.width,height:r.height}),r.canvas||(r.canvas={width:r.width,height:r.height}),s.width=r.canvas.width||320,s.height=r.canvas.height||240,i.width=r.video.width||320,i.height=r.video.height||240),(a=new GIFEncoder).setRepeat(0),a.setDelay(r.frameRate||200),a.setQuality(r.quality||10),a.start(),"function"==typeof r.onGifRecordingStarted&&r.onGifRecordingStarted(),u=h(function e(t){if(!0!==f.clearedRecordedData){if(n)return setTimeout(function(){e(t)},100);u=h(e),t-l<90||(!o&&i.paused&&i.play(),o||c.drawImage(i,0,0,s.width,s.height),r.onGifPreview&&r.onGifPreview(s.toDataURL("image/png")),a.addFrame(c),l=t)}}),r.initCallback&&r.initCallback()):setTimeout(f.record,1e3)},!(this.stop=function(e){e=e||function(){},u&&m(u),this.blob=new Blob([new Uint8Array(a.stream().bin)],{type:"image/gif"}),e(this.blob),a.stream().bin=[]}));this.pause=function(){n=!0},this.resume=function(){n=!1},this.clearRecordedData=function(){f.clearedRecordedData=!0,a&&(a.stream().bin=[])},this.name="GifRecorder",this.toString=function(){return this.name};var i,l,a,s=document.createElement("canvas"),c=s.getContext("2d"),t=(o&&(e instanceof CanvasRenderingContext2D?s=(c=e).canvas:e instanceof HTMLCanvasElement&&(c=e.getContext("2d"),s=e)),!0),u=(o||((i=document.createElement("video")).muted=!0,i.autoplay=!0,i.playsInline=!0,t=!1,i.onloadedmetadata=function(){t=!0},S(e,i),i.play()),null),f=this}function U(o,n){n=n||"multi-streams-mixer";var i=[],a=!1,s=document.createElement("canvas"),c=s.getContext("2d"),u=(s.style.opacity=0,s.style.position="absolute",s.style.zIndex=-1,s.style.top="-1000em",s.style.left="-1000em",s.className=n,(document.body||document.documentElement).appendChild(s),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0,this),e=window.AudioContext,t=(void 0===e&&("undefined"!=typeof webkitAudioContext&&(e=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(e=mozAudioContext)),window.URL),d=(void 0===t&&"undefined"!=typeof webkitURL&&(t=webkitURL),"undefined"!=typeof navigator&&void 0===navigator.getUserMedia&&(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia)),window.MediaStream),l=(void 0!==(d=void 0===d&&"undefined"!=typeof webkitMediaStream?webkitMediaStream:d)&&void 0===d.prototype.stop&&(d.prototype.stop=function(){this.getTracks().forEach(function(e){e.stop()})}),{});function f(){var e,t,r;a||(e=i.length,t=!1,r=[],i.forEach(function(e){e.stream||(e.stream={}),e.stream.fullcanvas?t=e:r.push(e)}),t?(s.width=t.stream.width,s.height=t.stream.height):r.length?(s.width=1<e?2*r[0].width:r[0].width,s.height=r[0].height*(9!==e&&10!==e?7!==e&&8!==e?5!==e&&6!==e?3!==e&&4!==e?1:2:3:4:5)):(s.width=u.width||360,s.height=u.height||240),t&&t instanceof HTMLVideoElement&&h(t),r.forEach(function(e,t){h(e,t)}),setTimeout(f,u.frameInterval))}function h(e,t){var r,o,n,i;a||(o=r=0,n=e.width,i=e.height,1===t&&(r=e.width),2===t&&(o=e.height),3===t&&(r=e.width,o=e.height),4===t&&(o=2*e.height),5===t&&(r=e.width,o=2*e.height),6===t&&(o=3*e.height),7===t&&(r=e.width,o=3*e.height),void 0!==e.stream.left&&(r=e.stream.left),void 0!==e.stream.top&&(o=e.stream.top),void 0!==e.stream.width&&(n=e.stream.width),void 0!==e.stream.height&&(i=e.stream.height),c.drawImage(e,r,o,n,i),"function"==typeof e.stream.onRender&&e.stream.onRender(c,r,o,n,i,t))}function m(e){var t,r,o=document.createElement("video");return t=e,!("srcObject"in(r=o))&&"mozSrcObject"in r?r.mozSrcObject=t:r.srcObject=t,o.className=n,o.muted=!0,o.volume=0,o.width=e.width||u.width||360,o.height=e.height||u.height||240,o.play(),o}function p(e){i=[],(e=e||o).forEach(function(e){var t;e.getTracks().filter(function(e){return"video"===e.kind}).length&&((t=m(e)).stream=e,i.push(t))})}void 0!==e?l.AudioContext=e:"undefined"!=typeof webkitAudioContext&&(l.AudioContext=webkitAudioContext),this.startDrawingFrames=function(){f()},this.appendStreams=function(e){if(!e)throw"First parameter is required.";(e=e instanceof Array?e:[e]).forEach(function(e){var t,r=new d;e.getTracks().filter(function(e){return"video"===e.kind}).length&&((t=m(e)).stream=e,i.push(t),r.addTrack(e.getTracks().filter(function(e){return"video"===e.kind})[0])),e.getTracks().filter(function(e){return"audio"===e.kind}).length&&(t=u.audioContext.createMediaStreamSource(e),u.audioDestination=u.audioContext.createMediaStreamDestination(),t.connect(u.audioDestination),r.addTrack(u.audioDestination.stream.getTracks().filter(function(e){return"audio"===e.kind})[0])),o.push(r)})},this.releaseStreams=function(){i=[],a=!0,u.gainNode&&(u.gainNode.disconnect(),u.gainNode=null),u.audioSources.length&&(u.audioSources.forEach(function(e){e.disconnect()}),u.audioSources=[]),u.audioDestination&&(u.audioDestination.disconnect(),u.audioDestination=null),u.audioContext&&u.audioContext.close(),u.audioContext=null,c.clearRect(0,0,s.width,s.height),s.stream&&(s.stream.stop(),s.stream=null)},this.resetVideoStreams=function(e){p(e=!e||e instanceof Array?e:[e])},this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=function(){a=!1,p(),"captureStream"in s?e=s.captureStream():"mozCaptureStream"in s?e=s.mozCaptureStream():u.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features"),t=new d,e.getTracks().filter(function(e){return"video"===e.kind}).forEach(function(e){t.addTrack(e)});var t,r=s.stream=t,e=function(){l.AudioContextConstructor||(l.AudioContextConstructor=new l.AudioContext);u.audioContext=l.AudioContextConstructor,u.audioSources=[],!0===u.useGainNode&&(u.gainNode=u.audioContext.createGain(),u.gainNode.connect(u.audioContext.destination),u.gainNode.gain.value=0);var r=0;if(o.forEach(function(e){if(!e.getTracks().filter(function(e){return e.kind==="audio"}).length)return;r++;var t=u.audioContext.createMediaStreamSource(e);if(u.useGainNode===true)t.connect(u.gainNode);u.audioSources.push(t)}),r)return u.audioDestination=u.audioContext.createMediaStreamDestination(),u.audioSources.forEach(function(e){e.connect(u.audioDestination)}),u.audioDestination.stream}();return e&&e.getTracks().filter(function(e){return"audio"===e.kind}).forEach(function(e){r.addTrack(e)}),o.forEach(function(e){e.fullcanvas}),r}}function F(r,o){r=r||[];var n,i,a=this;(o=o||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}}).frameInterval||(o.frameInterval=10),o.video||(o.video={}),o.video.width||(o.video.width=360),o.video.height||(o.video.height=240),this.record=function(){var t;n=new U(r,o.elementClass||"multi-streams-mixer"),t=[],r.forEach(function(e){E(e,"video").forEach(function(e){t.push(e)})}),t.length&&(n.frameInterval=o.frameInterval||10,n.width=o.video.width||360,n.height=o.video.height||240,n.startDrawingFrames()),o.previewStream&&"function"==typeof o.previewStream&&o.previewStream(n.getMixedStream()),(i=new g(n.getMixedStream(),o)).record()},this.stop=function(t){i&&i.stop(function(e){a.blob=e,t(e),a.clearRecordedData()})},this.pause=function(){i&&i.pause()},this.resume=function(){i&&i.resume()},this.clearRecordedData=function(){i&&(i.clearRecordedData(),i=null),n&&(n.releaseStreams(),n=null)},this.addStreams=function(e){if(!e)throw"First parameter is required.";e instanceof Array||(e=[e]),r.concat(e),i&&n&&(n.appendStreams(e),o.previewStream&&"function"==typeof o.previewStream&&o.previewStream(n.getMixedStream()))},this.resetVideoStreams=function(e){n&&(!e||e instanceof Array||(e=[e]),n.resetVideoStreams(e))},this.getMixer=function(){return n},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}function B(r,s){var c,o,n;function i(t,e){if(!s.workerPath&&!e)return c=!1,void fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(e){e.arrayBuffer().then(function(e){i(t,e)})});!s.workerPath&&e instanceof ArrayBuffer&&(e=new Blob([e],{type:"text/javascript"}),s.workerPath=T.createObjectURL(e)),s.workerPath||console.error("workerPath parameter is missing."),(o=new Worker(s.workerPath)).postMessage(s.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),o.addEventListener("message",function(e){"READY"===e.data?(o.postMessage({width:s.width,height:s.height,bitrate:s.bitrate||1200,timebaseDen:s.frameRate||30,realtime:s.realtime}),new ReadableStream({start:function(o){var n=document.createElement("canvas"),i=document.createElement("video"),a=!0;i.srcObject=r,i.muted=!0,i.height=s.height,i.width=s.width,i.volume=0,i.onplaying=function(){n.width=s.width,n.height=s.height;var e=n.getContext("2d"),t=1e3/s.frameRate,r=setInterval(function(){if(c&&(clearInterval(r),o.close()),a&&(a=!1,s.onVideoProcessStarted&&s.onVideoProcessStarted()),e.drawImage(i,0,0),"closed"!==o._controlledReadableStream.state)try{o.enqueue(e.getImageData(0,0,s.width,s.height))}catch(e){}},t)},i.play()}}).pipeTo(new WritableStream({write:function(e){c?console.error("Got image, but recorder is finished!"):o.postMessage(e.data.buffer,[e.data.buffer])}}))):e.data&&(n||a.push(e.data))})}"undefined"!=typeof ReadableStream&&"undefined"!=typeof WritableStream||console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),(s=s||{}).width=s.width||640,s.height=s.height||480,s.frameRate=s.frameRate||30,s.bitrate=s.bitrate||1200,s.realtime=s.realtime||!0,this.record=function(){n=!(a=[]),this.blob=null,i(r),"function"==typeof s.initCallback&&s.initCallback()},this.pause=function(){n=!0},this.resume=function(){n=!1};var a=[];this.stop=function(e){c=!0;var t,r=this;t=function(){r.blob=new Blob(a,{type:"video/webm"}),e(r.blob)},o?(o.addEventListener("message",function(e){null===e.data&&(o.terminate(),o=null,t&&t())}),o.postMessage(null)):t&&t()},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){n=!(a=[]),this.blob=null},this.blob=null}void 0!==A&&(A.DiskStorage=v),void 0!==A&&(A.GifRecorder=D),void 0===A&&(t.exports=U),void 0!==A&&(A.MultiStreamRecorder=F),void 0!==A&&(A.RecordRTCPromisesHandler=function(e,t){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(void 0===e)throw'First argument "MediaStream" is required.';var o=this;o.recordRTC=new A(e,t),this.startRecording=function(){return new Promise(function(e,t){try{o.recordRTC.startRecording(),e()}catch(e){t(e)}})},this.stopRecording=function(){return new Promise(function(t,r){try{o.recordRTC.stopRecording(function(e){o.blob=o.recordRTC.getBlob(),o.blob&&o.blob.size?t(e):r("Empty blob.",o.blob)})}catch(e){r(e)}})},this.pauseRecording=function(){return new Promise(function(e,t){try{o.recordRTC.pauseRecording(),e()}catch(e){t(e)}})},this.resumeRecording=function(){return new Promise(function(e,t){try{o.recordRTC.resumeRecording(),e()}catch(e){t(e)}})},this.getDataURL=function(e){return new Promise(function(t,r){try{o.recordRTC.getDataURL(function(e){t(e)})}catch(e){r(e)}})},this.getBlob=function(){return new Promise(function(e,t){try{e(o.recordRTC.getBlob())}catch(e){t(e)}})},this.getInternalRecorder=function(){return new Promise(function(e,t){try{e(o.recordRTC.getInternalRecorder())}catch(e){t(e)}})},this.reset=function(){return new Promise(function(e,t){try{e(o.recordRTC.reset())}catch(e){t(e)}})},this.destroy=function(){return new Promise(function(e,t){try{e(o.recordRTC.destroy())}catch(e){t(e)}})},this.getState=function(){return new Promise(function(e,t){try{e(o.recordRTC.getState())}catch(e){t(e)}})},this.blob=null,this.version="5.6.2"}),void 0!==A&&(A.WebAssemblyRecorder=B)}(RecordRTC$1),RecordRTC$1.exports),QNFaceActionLive=function(){function e(){}return e.create=function(){return new this},e.prototype.getRequestCode=function(e){return request.post("/face-actlive-session",e||{})},e.prototype.start=function(e,t){var t=t||{},r=t.encodeWidth,r=void 0===r?640:r,o=t.encodeHeight,o=void 0===o?480:o,n=t.encodeBitRate,n=void 0===n?18e4:n,i=t.encodeFPS,i=void 0===i?15:i,t=__rest(t,["encodeWidth","encodeHeight","encodeBitRate","encodeFPS"]),t=(this.params=t,new MediaStream([e.getMediaStreamTrack()]));return this.recorder=new RecordRTC(t,{type:"video",mimeType:"video/mp4",timeSlice:200,canvas:{width:r,height:o},bitrate:n,framerate:i}),this.recorder.startRecording(),this},e.prototype.commit=function(){var t=this;return new Promise(function(e){t.recorder.stopRecording(function(){e(t.recorder.getBlob())})}).then(function(t){return blobToDataURI(t).then(function(e){return console.log("base64Result",e),e.replace("data:".concat(t.type,";base64,"),"")})}).then(function(e){return request.post("/face-actlive-v2",__assign({video_base64:e},t.params))})},e}(),QNAuthorityActionFaceComparer=function(){function e(){}return e.create=function(){return new this},e.prototype.getRequestCode=function(e){return request.post("/face-actlive-session",e||{})},e.prototype.start=function(e,t,r){var o=QNFaceActionLive.create();return this.faceActionLiveDetector=o.start(e,t),this.authoritativeFaceParams=r,this.videoTrack=e,this},e.prototype.commit=function(){return Promise.all([this.faceActionLiveDetector.commit(),QNAuthoritativeFaceComparer.run(this.videoTrack,this.authoritativeFaceParams)]).then(function(e){return{faceActionResult:e[0],authoritativeFaceResult:e[1]}})},e}(),QNFaceComparer=function(){function e(){}return e.run=function(e,t){var t=t||{},r=t.captureWidth,o=void 0===r?240:r,r=t.captureHeight,n=void 0===r?320:r,r=t.captureQuality,i=void 0===r?90:r,a=__rest(t,["captureWidth","captureHeight","captureQuality"]),r=e.getCurrentFrameData();return imageConversion.dataURLtoFile(r).then(function(e){return imageConversion.compress(e,{width:o,height:n,quality:i})}).then(function(e){return imageConversion.filetoDataURL(e)}).then(function(e){return request.post("/face-compare-v2",[{image:e.replace(/^data:image\/\w+;base64,/,""),image_type:"BASE64",face_type:"LIVE"},a])})},e}(),QNFaceDetector=function(){function e(){}return e.run=function(e,t){var t=t||{},r=t.captureWidth,o=void 0===r?240:r,r=t.captureHeight,n=void 0===r?320:r,r=t.captureQuality,i=void 0===r?90:r,a=__rest(t,["captureWidth","captureHeight","captureQuality"]),r=e.getCurrentFrameData();return imageConversion.dataURLtoFile(r).then(function(e){return imageConversion.compress(e,{width:o,height:n,quality:i})}).then(function(e){return imageConversion.filetoDataURL(e)}).then(function(e){return request.post("/face-detect-v2",__assign({image:e.replace(/^data:image\/\w+;base64,/,""),image_type:"BASE64",face_type:"LIVE"},a))})},e}(),QNFaceFlashLiveDetector=function(){function e(){}return e.start=function(t,e){var e=e||15,r=new this;return r.frameRate=e,r.videoData=[],r.timer=setInterval(function(){var e=t.getCurrentFrameData().replace("data:image/png;base64,","");r.videoData.push({image:e})},1e3/e),r},e.prototype.commit=function(){return clearInterval(this.timer),request.post("/face-flashlive",{video_data:this.videoData})},e}(),QNIDCardDetector=function(){function e(){}return e.run=function(e,t){e=e.getCurrentFrameData();return request.post("/ocr-idcard",__assign({image:e.replace("data:image/png;base64,","")},t))},e}(),QNOCRDetector=function(){function e(){}return e.run=function(e){return request.post("/general-ocr",{"data.uri":"data:application/octet-stream;base64,"+e.getCurrentFrameData().split(",")[1]})},e}(),QNTextToSpeakAnalyzer=function(){function e(){}return e.run=function(e){return request.post("/voice-tts-v2",__assign({content:e.content},e))},e}();export{QNAudioToTextAnalyzer,QNAudioToTextStatus,QNAuthoritativeFaceComparer,QNAuthorityActionFaceComparer,QNFaceActionLive,QNFaceComparer,QNFaceDetector,QNFaceFlashLiveDetector,QNIDCardDetector,QNOCRDetector,QNRtcAiManager,QNTextToSpeakAnalyzer,version};
